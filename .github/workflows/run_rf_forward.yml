name: Run RF Forward (Manual Only)

on:
  workflow_dispatch:   # üëà ch·ªâ ch·∫°y th·ªß c√¥ng

jobs:
  run-script:
    runs-on: ubuntu-latest

    steps:
      # 1Ô∏è‚É£ L·∫•y code trong repo
      - name: Checkout repository
        uses: actions/checkout@v4

      # 2Ô∏è‚É£ C√†i Python
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      # 3Ô∏è‚É£ C√†i th∆∞ vi·ªán c·∫ßn thi·∫øt
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pandas numpy scikit-learn imbalanced-learn matplotlib

      # 4Ô∏è‚É£ Ch·∫°y script ch√≠nh
      - name: Run RF Forward training
        run: |
          python rf_forward_train.py

      # 5Ô∏è‚É£ N√©n th∆∞ m·ª•c results th√†nh file zip
      - name: Zip results folder
        run: |
          zip -r results_${{ github.run_number }}.zip results/

      # 6Ô∏è‚É£ T·∫£i file zip l√™n GitHub Releases
      - name: Create GitHub Release and Upload Results
        uses: softprops/action-gh-release@v1
        with:
          tag_name: run-${{ github.run_number }}
          name: "RF Forward Results #${{ github.run_number }}"
          body: "K·∫øt qu·∫£ hu·∫•n luy·ªán Random Forest + SMOTETomek + Calibration (Sigmoid)"
          files: results_${{ github.run_number }}.zip
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
